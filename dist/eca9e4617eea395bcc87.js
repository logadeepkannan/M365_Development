var msalConfig={auth:{clientId:"afa1af36-1e13-4a8b-bb5a-0d0bfba72bb2",authority:"https://login.microsoftonline.com/059227af-dbff-4759-b2c3-8e7e7945fcdb",redirectUri:"https://ittridentsqa.sharepoint.com"}},msalInstance=new msal.PublicClientApplication(msalConfig),loginRequest={scopes:["https://ittridentsqa.sharepoint.com/.default"]};function getAccessToken(){return msalInstance.acquireTokenSilent(loginRequest).then((function(e){return e.accessToken})).catch((function(e){return msalInstance.loginPopup(loginRequest).then((function(e){return e.accessToken})).catch((function(e){console.error("Login failed: ",e)}))}))}function populateDropdown(){var e=document.getElementById("projectDropdown");getAccessToken().then((function(t){fetch("https://ittridentsqa.sharepoint.com/sites/TridentSQAM365InternalSolution/_api/web/lists/getbytitle('Project_Dropdown')/items",{method:"GET",headers:{Accept:"application/json;odata=verbose",Authorization:"Bearer "+t}}).then((function(e){return e.json()})).then((function(t){for(;e.options.length>1;)e.remove(1);t.d.results.forEach((function(t){var n=document.createElement("option");n.value=t.Title,n.text=t.Title,e.add(n)}))})).catch((function(e){return console.error("Error fetching SharePoint list: ",e)}))}))}function addProjectToSubject(){var e=document.getElementById("projectDropdown").value;e&&"Select a project"!==e?Office.context.mailbox.item.subject.setAsync(e,(function(e){e.status===Office.AsyncResultStatus.Succeeded?console.log("Subject updated successfully."):console.error(e.error.message)})):console.log("Please select a valid project.")}function validateSubjectAndCC(e){shouldChangeSubjectOnSend(e)}function shouldChangeSubjectOnSend(e){mailboxItem.subject.getAsync({asyncContext:e},(function(e){addCCOnSend(e.asyncContext);var t=new RegExp(/\[Checked\]/).test(e.value);subject="[Checked]: "+e.value,null===e.value||/^\s*$/.test(e.value)?(mailboxItem.notificationMessages.addAsync("NoSend",{type:"errorMessage",message:"Please enter a subject for this email."}),e.asyncContext.completed({allowEvent:!1})):t?e.asyncContext.completed({allowEvent:!0}):subjectOnSendChange(subject,e.asyncContext)}))}function subjectOnSendChange(e,t){mailboxItem.subject.setAsync(e,{asyncContext:t},(function(e){e.status==Office.AsyncResultStatus.Failed?(mailboxItem.notificationMessages.addAsync("NoSend",{type:"errorMessage",message:"Unable to set the subject."}),e.asyncContext.completed({allowEvent:!1})):e.asyncContext.completed({allowEvent:!0})}))}Office.onReady((function(e){e.host===Office.HostType.Outlook&&(populateDropdown(),document.getElementById("projectDropdown").onchange=addProjectToSubject)}));